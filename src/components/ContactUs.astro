---
// const contactDetails = [
//   { label: 'Email', value: 'support@universityx.com' },
//   { label: 'Phone', value: '+1 (555) 123-4567' },
//   { label: 'Address', value: '90 Financial Street, Suite 304, San Francisco, CA 94105, USA' },
// ];
---

<section id="contact" class="bg-[#FBF8F1] py-20 md:py-28">
  <!-- Hero Header -->
  <div class="max-w-3xl mx-auto text-center px-6 mb-16 md:mb-20">
    <h2 class="text-4xl md:text-5xl lg:text-6xl font-extrabold text-[#1A0533] leading-tight">
      We're Always Here to
      <br />
      <em class="font-['Playfair_Display',serif] font-bold not-italic">Help You Out</em>
    </h2>
    <p class="mt-5 text-gray-500 text-base md:text-lg leading-relaxed">
      Let UniversityX help you learn, grow, and build job-ready skills&mdash;so you can
      earn smarter, grow faster, and stress less.
    </p>
  </div>

  <!-- Two-column content -->
  <div class="max-w-7xl mx-auto px-6 md:px-12 lg:px-16 xl:px-24 grid grid-cols-1 lg:grid-cols-5 gap-12 lg:gap-16 items-start">

    <!-- Left column: Text + Contact Details -->
    <div class="lg:col-span-2">
      <h3 class="text-3xl md:text-4xl font-extrabold text-[#1A0533] leading-snug">
        Have a question,
        <br />
        feedback, or just
        <br />
        <em class="font-['Playfair_Display',serif] font-bold">want to say hello?</em>
      </h3>

      <p class="mt-6 text-gray-500 text-base leading-relaxed max-w-sm">
        Use the form or reach out directly. Our support team
        usually responds within a few hours.
      </p>

      <!-- <div class="mt-10">
        <h4 class="text-lg font-bold text-[#1A0533] mb-4">Contact Details:</h4>
        <div class="space-y-2 text-base text-gray-600">
          {contactDetails.map((item) => (
            <p>
              <span class="font-semibold text-[#1A0533]">{item.label}:</span>{' '}
              {item.value}
            </p>
          ))}
        </div>
      </div> -->
    </div>

    <!-- Right column: Form Card -->
    <div class="lg:col-span-3">
      <div class="bg-white rounded-3xl shadow-xl p-8 md:p-10">
        <form
          id="contact-form"
          name="contact"
          method="POST"
          data-netlify="true"
          netlify-honeypot="bot-field"
          novalidate
          class="space-y-6"
        >
          <p class="hidden">
            <label>
              Don&#8217;t fill this out if you&#8217;re human: <input name="bot-field" type="text" />
            </label>
          </p>
          <input type="hidden" name="form-name" value="contact" />

          <!-- Full name -->
          <div>
            <label for="contact-name" class="block text-sm font-semibold text-[#1A0533] mb-2">Full name</label>
            <input
              type="text"
              id="contact-name"
              name="full-name"
              placeholder="Enter your full name"
              required
              class="w-full bg-gray-50 rounded-xl px-4 py-3 text-sm text-gray-800 placeholder-gray-400 border border-transparent focus:outline-none focus:ring-2 focus:ring-[#D4A853] transition-shadow"
            />
          </div>

          <!-- Email -->
          <div>
            <label for="contact-email" class="block text-sm font-semibold text-[#1A0533] mb-2">Email</label>
            <input
              type="email"
              id="contact-email"
              name="email"
              placeholder="Enter your email"
              required
              class="w-full bg-gray-50 rounded-xl px-4 py-3 text-sm text-gray-800 placeholder-gray-400 border border-transparent focus:outline-none focus:ring-2 focus:ring-[#D4A853] transition-shadow"
            />
            <p id="email-error" class="text-red-500 text-xs mt-1 hidden">Please enter a valid email address.</p>
          </div>

          <!-- Phone number -->
          <div>
            <label for="contact-phone" class="block text-sm font-semibold text-[#1A0533] mb-2">Phone number</label>
            <input
              type="tel"
              id="contact-phone"
              name="phone"
              placeholder="Phone number"
              required
              class="w-full bg-gray-50 rounded-xl px-4 py-3 text-sm text-gray-800 placeholder-gray-400 border border-transparent focus:outline-none focus:ring-2 focus:ring-[#D4A853] transition-shadow"
            />
            <p id="phone-error" class="text-red-500 text-xs mt-1 hidden">Please enter a valid phone number (7â€“20 digits).</p>
          </div>

          <!-- Message -->
          <div>
            <label for="contact-message" class="block text-sm font-semibold text-[#1A0533] mb-2">Message</label>
            <textarea
              id="contact-message"
              name="message"
              placeholder="Type your message here"
              rows="4"
              required
              class="w-full bg-gray-50 rounded-xl px-4 py-3 text-sm text-gray-800 placeholder-gray-400 border border-transparent focus:outline-none focus:ring-2 focus:ring-[#D4A853] transition-shadow resize-y"
            ></textarea>
          </div>

          <!-- Privacy checkbox -->
          <!-- <div class="flex items-start gap-3">
            <input
              type="checkbox"
              id="contact-privacy"
              name="privacy"
              required
              class="mt-0.5 w-4 h-4 rounded border-gray-300 text-[#D4A853] focus:ring-[#D4A853] cursor-pointer"
            />
            <label for="contact-privacy" class="text-sm text-gray-500">
              By reaching out to us, you agree to our
              <a href="#" class="text-[#1A0533] font-semibold underline hover:text-[#BB39B4] transition-colors">Privacy Policy</a>.
            </label>
          </div> -->

          <!-- Submit button -->
          <button
            type="submit"
            class="w-full bg-[#BB39B4] hover:bg-[#BB39B4] text-white font-bold text-base rounded-full py-3.5 transition-colors duration-200 cursor-pointer"
          >
            Send Message
          </button>
        </form>
      </div>
    </div>

  </div>
</section>

<script>
  function initContactForm() {
    const form = document.getElementById('contact-form') as HTMLFormElement | null;
    if (!form) return;

    const emailInput = form.querySelector('#contact-email') as HTMLInputElement;
    const phoneInput = form.querySelector('#contact-phone') as HTMLInputElement;
    const emailError = document.getElementById('email-error')!;
    const phoneError = document.getElementById('phone-error')!;

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const phoneRegex = /^[\d\s+\-()]{7,20}$/;

    function validateEmail(): boolean {
      const valid = emailRegex.test(emailInput.value.trim());
      emailError.classList.toggle('hidden', valid || emailInput.value.trim() === '');
      return valid;
    }

    function validatePhone(): boolean {
      const valid = phoneRegex.test(phoneInput.value.trim());
      phoneError.classList.toggle('hidden', valid || phoneInput.value.trim() === '');
      return valid;
    }

    emailInput.addEventListener('blur', validateEmail);
    phoneInput.addEventListener('blur', validatePhone);

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const emailOk = validateEmail();
      const phoneOk = validatePhone();

      if (!emailOk || !phoneOk) return;

      const formData = new FormData(form);

      try {
        await fetch('/', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: new URLSearchParams(formData as any).toString(),
        });

        // Track successful contact form submission in PostHog
        window.posthog?.capture('contact_form_submitted', {
          form_name: 'contact'
        });

        form.reset();
        emailError.classList.add('hidden');
        phoneError.classList.add('hidden');
        alert('Message sent successfully! We\'ll get back to you soon.');
      } catch (err) {
        // Capture form submission error in PostHog
        window.posthog?.captureException(err);
        alert('Something went wrong. Please try again.');
      }
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initContactForm);
  } else {
    initContactForm();
  }
</script>
